# 音声文字起こし Web アプリ作成ガイド

このドキュメントでは、リポジトリ内の Flask アプリをローカル環境にセットアップし、音声ファイルをテキストに変換するまでの手順をまとめています。README の簡潔な手順に加えて、画面構成や開発時のヒントを知りたい場合に参照してください。

## 事前準備

- Python 3.10 以上
- FFmpeg（Whisper のエンコードで必要）
- OpenAI API キー（Whisper API を利用する場合）

## 仮想環境と依存関係のインストール

```bash
python -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
```

上記で `Flask` と `openai-whisper` ライブラリがインストールされます。初回実行時は Whisper モデルのダウンロードに時間がかかる点に注意してください。

## 環境変数の設定

`.env` などに以下を設定することで、アプリ起動時の設定をカスタマイズできます。

- `TEXTMAKE_SECRET_KEY`: Flask セッション用のシークレットキー
- `TEXTMAKE_WHISPER_MODEL`: 使用する Whisper モデル名（`tiny`/`base`/`small` など）

## アプリの起動

```bash
flask --app app run --host 0.0.0.0 --port 5000 --debug
```

`http://localhost:5000` を開くと、音声ファイルのアップロードフォームが表示されます。変換処理が完了すると、ブラウザがテキストファイルのダウンロードを開始します。

## フロントエンドの構成

- `templates/index.html`: アップロードフォームと結果メッセージを定義
- `static/css/style.css`: ボタンやレイアウトのスタイル指定

これらのファイルを編集することで、ブランドカラーや文言を簡単に変更できます。

## トラブルシューティング

- **依存関係のインストールに失敗する**: プロキシ環境の場合は、`pip` のプロキシ設定を確認してください。
- **Whisper モデルのダウンロードが遅い**: 一度ダウンロードすると `~/.cache/whisper` に保存され、次回以降は高速に起動できます。
- **ブラウザでダウンロードが始まらない**: サーバーログにエラーが出ていないか、音声ファイル形式がサポート対象かを確認してください（WAV/MP3/M4A/FLAC 等）。

## 次のステップ

- Docker 化して配布しやすくする
- Whisper API を利用してサーバー負荷を軽減する
- テキスト編集機能を追加して書き起こし結果を整形しやすくする

開発を進める際の詳細なメモや改善案があれば、このドキュメントに追記してください。
